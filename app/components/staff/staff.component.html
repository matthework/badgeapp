<!-- Header -->
<div class="docs-header">
   <h1 class=" col-md-10 col-md-offset-1" >
      <span *ngIf="staffs">Person</span>
      <span *ngIf="!staffs && auth.isAdmin()" >Add New Person</span>
      <span *ngIf="!staffs && !auth.isAdmin()">There is NO Person!</span>
   </h1>
</div>

<!-- Content -->
<div *ngIf="auth.isAdmin()" class="col-md-10 col-md-offset-1">

  <div *ngIf="staffs">
    <div class="form-inline">
      <div *ngIf="staffs" class="form-group">
        <input [(ngModel)]="query" placeholder="Search for">
        <button class="button-showbs" *ngIf!="showBS" (click)="showBS=true">Show BadgeSet</button>
        <button class="button-back" *ngIf="showBS" (click)="showBS=false">Show Badges</button>
        <button class="button-add" *ngIf="auth.isAdmin()" (click)="addStaff()">+</button>
      </div>

      <div *ngIf="!staffs && auth.isAdmin()" class="form-group">
        <input [(ngModel)]="query" placeholder="Search for">
        <button class="btn btn-default" (click)="addStaff()">+</button><br>
      </div>
    </div>
    <br>

    <table *ngIf!="showBS" class="table-staffs">
      <tr>
        <th class="th-name">Name</th>
        <th class="th-bg">Badges</th>
        <th class="th-topbs">Top BadgeSet</th>
        <th class="th-status">Status</th>
        <th class="th-last"></th>
      </tr>
      <tr *ngFor="let staff of staffs | filter:query">
        <td (click)="onSelect(staff);toStaffDetail(staff._id)" class="staff">{{staff.fname}} {{staff.lname}}</td>
        <td class="td-badges">
      	<div *ngFor="let userbgroup of staff.userbgroups">
      	<li>
      	<text class="" (click)="toBadgeDetail(userbgroup.bid)"><text *ngIf="userbgroup.status" class="text-blue">{{getBadgeName(userbgroup.bid)}} {{userbgroup.level}}</text><text *ngIf="userbgroup.focus.length!=0 && userbgroup.status" class="focus"> [{{userbgroup.focus}}]</text>
        <text *ngIf="!userbgroup.status" class="badge-pending">{{getBadgeName(userbgroup.bid)}} {{userbgroup.level}} </text><text *ngIf="userbgroup.focus.length!=0 && !userbgroup.status" class="focus-pending"> [{{userbgroup.focus}}]</text></text>
        <button *ngIf="!userbgroup.status" class="button-approve" (click)="userbgroup.status=true;approveBadge(staff,userbgroup)">Approve</button>
      	</li>
      	</div>
      	</td>
      	<td class="badgeset" (click)="toBSDetail(getTopStaffBS(staff.userbgroups)[0])">{{getTopStaffBS(staff.userbgroups)[1]}}</td>
        <td class="td-status" (click)="onSelect(staff)">{{staff.status}}</td>
        <td *ngIf="auth.isAdmin()" class="td-last"><button class="button-s-x" (click)="deleteStaffPop(staff._id)">X</button></td>
      </tr>
    </table>

    <table *ngIf="showBS" class="table-sbs">
      <tr>
        <th class="th-sname">Name</th>
        <th class="th-bs">Badge Sets</th>
        <th class="th-tier">Tier / Grade</th>
        <th class="th-pay">$$</th>
        <th class="th-last"></th>
      </tr>
      <tr *ngFor="let staff of staffs | filter:query">
        <td (click)="onSelect(staff);toStaffDetail(staff._id)" class="staff">{{staff.fname}} {{staff.lname}}</td>
        <td class="td-bs">
        <div *ngFor="let bs of getSortStaffBS(staff.userbgroups)">
    		<li class="li-bs" (click)="toBSDetail(bs._id)">{{bs.name}}</li>
    	</div>
    	</td>
        <td class="td-tier" (click)="onSelect(staff)">
       	<div *ngFor="let bs of getSortStaffBS(staff.userbgroups)">
    		<li>{{bs.tier}} - {{bs.grade}}</li>
    	</div>
    	</td>
        <td class="td-pay" (click)="onSelect(staff)">
       	<div *ngFor="let bs of getSortStaffBS(staff.userbgroups)">
    		<li>${{bs.pay}}K</li>
    	</div>
        </td>
        <td *ngIf="auth.isAdmin()" class="td-last"><button class="button-s-x" (click)="deleteStaffPop(staff._id)">X</button></td>
      </tr>
    </table>
  </div>

</div>

<br>
<div *ngIf="!auth.authenticated()">
<h3><i>You are not logged in, please click 'Log in' button to login.</i></h3>
{{auth.login()}}
</div>


